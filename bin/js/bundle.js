var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";
/**This class is automatically generated by LayaAirIDE, please do not make any modifications. */
Object.defineProperty(exports, "__esModule", { value: true });
/*
* 游戏初始化配置;
*/
var GameConfig = /** @class */ (function () {
    function GameConfig() {
    }
    GameConfig.init = function () {
        var reg = Laya.ClassUtils.regClass;
    };
    GameConfig.width = 480;
    GameConfig.height = 800;
    GameConfig.scaleMode = "fixedwidth";
    GameConfig.screenMode = "none";
    GameConfig.alignV = "top";
    GameConfig.alignH = "left";
    GameConfig.startScene = "";
    GameConfig.sceneRoot = "";
    GameConfig.debug = false;
    GameConfig.stat = false;
    GameConfig.physicsDebug = false;
    GameConfig.exportSceneToJson = true;
    return GameConfig;
}());
exports.default = GameConfig;
GameConfig.init();
},{}],2:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var GameConfig_1 = require("./GameConfig");
var GameBgMap_1 = require("./logic/GameBgMap");
var GamePanel = /** @class */ (function () {
    function GamePanel() {
        /**
         * 0 idl
         * 1 enter
         * 2 exit
         */
        this.curState = 0;
        this.init();
    }
    GamePanel.prototype.init = function () {
        this._view = fairygui.UIPackage.createObject("Game", "Game").asCom;
        this._view.setSize(GameConfig_1.default.width, GameConfig_1.default.height);
    };
    GamePanel.prototype.onEnter = function () {
        if (this.curState === 1)
            return;
        this.curState = 1;
        fairygui.GRoot.inst.addChild(this._view);
        this.initMap();
    };
    GamePanel.prototype.onExit = function () {
        if (this.curState === 2)
            return;
        this.curState = 2;
        fairygui.GRoot.inst.removeChild(this._view);
    };
    GamePanel.prototype.initMap = function () {
        var map1 = this._view.getChild('n0').asCom;
        var map2 = this._view.getChild('n1').asCom;
        if (!this.mapLogic) {
            this.mapLogic = new GameBgMap_1.default(map1, map2);
        }
        this.mapLogic.runMap();
    };
    return GamePanel;
}());
exports.default = GamePanel;
},{"./GameConfig":1,"./logic/GameBgMap":5}],3:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var GameConfig_1 = require("./GameConfig");
var Loader = laya.net.Loader;
var UIMgr_1 = require("./utils/UIMgr");
var Main = /** @class */ (function () {
    function Main() {
        //根据IDE设置初始化引擎		
        if (window["Laya3D"])
            Laya3D.init(GameConfig_1.default.width, GameConfig_1.default.height);
        else
            Laya.init(GameConfig_1.default.width, GameConfig_1.default.height, Laya["WebGL"]);
        Laya["Physics"] && Laya["Physics"].enable();
        Laya["DebugPanel"] && Laya["DebugPanel"].enable();
        Laya.stage.scaleMode = GameConfig_1.default.scaleMode;
        Laya.stage.screenMode = GameConfig_1.default.screenMode;
        //兼容微信不支持加载scene后缀场景
        Laya.URL.exportSceneToJson = GameConfig_1.default.exportSceneToJson;
        //打开调试面板（通过IDE设置调试模式，或者url地址增加debug=true参数，均可打开调试面板）
        if (GameConfig_1.default.debug || Laya.Utils.getQueryString("debug") == "true")
            Laya.enableDebugPanel();
        if (GameConfig_1.default.physicsDebug && Laya["PhysicsDebugDraw"])
            Laya["PhysicsDebugDraw"].enable();
        if (GameConfig_1.default.stat)
            Laya.Stat.show();
        Laya.alertGlobalError = true;
        //激活资源版本控制，version.json由IDE发布功能自动生成，如果没有也不影响后续流程
        Laya.ResourceVersion.enable("version.json", Laya.Handler.create(this, this.onVersionLoaded), Laya.ResourceVersion.FILENAME_VERSION);
    }
    Main.prototype.onVersionLoaded = function () {
        //激活大小图映射，加载小图的时候，如果发现小图在大图合集里面，则优先加载大图合集，而不是小图
        Laya.AtlasInfoManager.enable("fileconfig.json", Laya.Handler.create(this, this.onConfigLoaded));
    };
    Main.prototype.onConfigLoaded = function () {
        //加载IDE指定的场景
        // GameConfig.startScene && Laya.Scene.open(GameConfig.startScene);
        Laya.loader.load([{
                url: 'res/Login_atlas0.png', type: Loader.IMAGE
            }, {
                url: 'res/Login.fui', type: Loader.BUFFER
            }, {
                url: 'res/Game_atlas0.png', type: Loader.IMAGE
            }, {
                url: 'res/Game.fui', type: Loader.BUFFER
            }], Laya.Handler.create(this, this.onLoaded));
    };
    Main.prototype.onLoaded = function () {
        Laya.stage.addChild(fairygui.GRoot.inst.displayObject);
        fairygui.UIPackage.addPackage("res/Login");
        fairygui.UIPackage.addPackage("res/Game");
        // UIMgr.Instance().enterLogin();
        UIMgr_1.default.Instance().enterGame();
    };
    return Main;
}());
//激活启动类
new Main();
},{"./GameConfig":1,"./utils/UIMgr":7}],4:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var GameConfig_1 = require("./GameConfig");
var MusicWin_1 = require("./ui/MusicWin");
var MainPanel = /** @class */ (function () {
    function MainPanel() {
        /**
         * 0 idl
         * 1 enter
         * 2 exit
         */
        this.curState = 0;
        this.init();
    }
    MainPanel.prototype.init = function () {
        this._view = fairygui.UIPackage.createObject("Login", "Login").asCom;
        this._view.setSize(GameConfig_1.default.width, GameConfig_1.default.height);
        this.bindBtn(this._view);
    };
    MainPanel.prototype.bindBtn = function (view) {
        var _this = this;
        view.getChild("n1").onClick(this, function (data) {
            //
            console.log(data);
        });
        view.getChild("musicBtn").onClick(this, function (data) {
            if (!_this.audioWin) {
                _this.audioWin = new MusicWin_1.default();
            }
            _this.audioWin.show();
        });
    };
    MainPanel.prototype.onEnter = function () {
        if (this.curState === 1)
            return;
        this.curState = 1;
        fairygui.GRoot.inst.addChild(this._view);
    };
    MainPanel.prototype.onExit = function () {
        if (this.curState === 2)
            return;
        this.curState = 2;
        fairygui.GRoot.inst.removeChild(this._view);
    };
    return MainPanel;
}());
exports.MainPanel = MainPanel;
},{"./GameConfig":1,"./ui/MusicWin":6}],5:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var GameBgMap = /** @class */ (function () {
    function GameBgMap(map1, map2) {
        this.speed = 2;
        this.map1 = map1;
        this.map2 = map2;
        this.mapHeigth = this.map1.height;
        this.mapStartY = map1.y;
    }
    GameBgMap.prototype.runMap = function () {
        Laya.timer.loop(16, this, this.moveYUpdate);
    };
    GameBgMap.prototype.moveYUpdate = function () {
        this.runMoveY(this.map1, this.speed);
        this.runMoveY(this.map2, this.speed);
        if (this.isTransform(this.map1, this.map2)) {
            this.transform(this.map1, this.map2);
        }
        if (this.isTransform(this.map2, this.map1)) {
            this.transform(this.map2, this.map1);
        }
    };
    GameBgMap.prototype.runMoveY = function (target, offsetY) {
        target.y += -offsetY;
    };
    GameBgMap.prototype.isTransform = function (map1, map2) {
        console.log(map1.y, map2.y);
        if (map1.y <= (this.mapStartY - this.mapHeigth) &&
            map2.y <= this.mapStartY) {
            return true;
        }
        return false;
    };
    GameBgMap.prototype.transform = function (map1, map2) {
        map1.y = map2.y + this.mapHeigth;
    };
    return GameBgMap;
}());
exports.default = GameBgMap;
},{}],6:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var MusicWin = /** @class */ (function (_super) {
    __extends(MusicWin, _super);
    function MusicWin() {
        return _super.call(this) || this;
    }
    MusicWin.prototype.onInit = function () {
        this.contentPane = fairygui.UIPackage.createObject("Login", "AudioWin").asCom;
        this.center();
        this.contentPane.getChild("musicSwitch").onClick(this, this.onEventMusic);
        this.contentPane.getChild("effectSwitch").onClick(this, this.onEventEffeck);
        this.contentPane.getChild("closeBtn").onClick(this, this.onEventClose);
    };
    MusicWin.prototype.onShown = function () {
        console.log(0);
    };
    MusicWin.prototype.onEventMusic = function (event) {
        console.log(0);
    };
    MusicWin.prototype.onEventEffeck = function (event) {
        console.log(0);
    };
    MusicWin.prototype.onEventClose = function (event) {
        this.hide();
    };
    return MusicWin;
}(fairygui.Window));
exports.default = MusicWin;
},{}],7:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var MainPanel_1 = require("../MainPanel");
var GamePanel_1 = require("../GamePanel");
var UIMgr = /** @class */ (function () {
    function UIMgr() {
    }
    UIMgr.Instance = function () {
        if (!UIMgr.instance) {
            UIMgr.instance = new UIMgr();
        }
        return UIMgr.instance;
    };
    UIMgr.prototype.enterLogin = function () {
        if (!this.loginPanel) {
            this.loginPanel = new MainPanel_1.MainPanel();
        }
        this.loginPanel.onEnter();
        if (this.gamePanel) {
            this.gamePanel.onExit();
        }
    };
    UIMgr.prototype.enterGame = function () {
        if (!this.gamePanel) {
            this.gamePanel = new GamePanel_1.default();
        }
        this.gamePanel.onEnter();
        if (this.loginPanel) {
            this.loginPanel.onExit();
        }
    };
    return UIMgr;
}());
exports.default = UIMgr;
},{"../GamePanel":2,"../MainPanel":4}]},{},[3])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL0xheWFBaXJJREUvcmVzb3VyY2VzL2FwcC9ub2RlX21vZHVsZXMvYnJvd3Nlci1wYWNrL19wcmVsdWRlLmpzIiwic3JjL0dhbWVDb25maWcudHMiLCJzcmMvR2FtZVBhbmVsLnRzIiwic3JjL01haW4udHMiLCJzcmMvTWFpblBhbmVsLnRzIiwic3JjL2xvZ2ljL0dhbWVCZ01hcC50cyIsInNyYy91aS9NdXNpY1dpbi50cyIsInNyYy91dGlscy9VSU1nci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1ZBLGdHQUFnRzs7QUFFaEc7O0VBRUU7QUFDRjtJQWFJO0lBQWMsQ0FBQztJQUNSLGVBQUksR0FBWDtRQUNJLElBQUksR0FBRyxHQUFhLElBQUksQ0FBQyxVQUFVLENBQUMsUUFBUSxDQUFDO0lBRWpELENBQUM7SUFoQk0sZ0JBQUssR0FBUSxHQUFHLENBQUM7SUFDakIsaUJBQU0sR0FBUSxHQUFHLENBQUM7SUFDbEIsb0JBQVMsR0FBUSxZQUFZLENBQUM7SUFDOUIscUJBQVUsR0FBUSxNQUFNLENBQUM7SUFDekIsaUJBQU0sR0FBUSxLQUFLLENBQUM7SUFDcEIsaUJBQU0sR0FBUSxNQUFNLENBQUM7SUFDckIscUJBQVUsR0FBSyxFQUFFLENBQUM7SUFDbEIsb0JBQVMsR0FBUSxFQUFFLENBQUM7SUFDcEIsZ0JBQUssR0FBUyxLQUFLLENBQUM7SUFDcEIsZUFBSSxHQUFTLEtBQUssQ0FBQztJQUNuQix1QkFBWSxHQUFTLEtBQUssQ0FBQztJQUMzQiw0QkFBaUIsR0FBUyxJQUFJLENBQUM7SUFNMUMsaUJBQUM7Q0FsQkQsQUFrQkMsSUFBQTtrQkFsQm9CLFVBQVU7QUFtQi9CLFVBQVUsQ0FBQyxJQUFJLEVBQUUsQ0FBQzs7OztBQ3hCbEIsMkNBQXNDO0FBQ3RDLCtDQUEwQztBQUUxQztJQVlJO1FBVEE7Ozs7V0FJRztRQUNLLGFBQVEsR0FB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LENBQUM7SUFFRCwrQkFBWSxHQUFaLFVBQWEsS0FBSztRQUNkLElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUNoQixDQUFDO0lBRUwsZUFBQztBQUFELENBOUJBLEFBOEJDLENBOUJxQyxRQUFRLENBQUMsTUFBTSxHQThCcEQ7Ozs7O0FDOUJELDBDQUF5QztBQUN6QywwQ0FBcUM7QUFFckM7SUFpQ0k7SUFBZ0IsQ0FBQztJQTdCSCxjQUFRLEdBQXRCO1FBQ0ksSUFBSSxDQUFDLEtBQUssQ0FBQyxRQUFRLEVBQUU7WUFDakIsS0FBSyxDQUFDLFFBQVEsR0FBRyxJQUFJLEtBQUssRUFBRSxDQUFDO1NBQ2hDO1FBQ0QsT0FBTyxLQUFLLENBQUMsUUFBUSxDQUFDO0lBQzFCLENBQUM7SUFLTSwwQkFBVSxHQUFqQjtRQUNJLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxFQUFFO1lBQ2xCLElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxxQkFBUyxFQUFFLENBQUM7U0FDckM7UUFDRCxJQUFJLENBQUMsVUFBVSxDQUFDLE9BQU8sRUFBRSxDQUFDO1FBQzFCLElBQUksSUFBSSxDQUFDLFNBQVMsRUFBRTtZQUNoQixJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sRUFBRSxDQUFDO1NBQzNCO0lBQ0wsQ0FBQztJQUVNLHlCQUFTLEdBQWhCO1FBQ0ksSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUU7WUFDakIsSUFBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLG1CQUFTLEVBQUUsQ0FBQztTQUNwQztRQUNELElBQUksQ0FBQyxTQUFTLENBQUMsT0FBTyxFQUFFLENBQUM7UUFDekIsSUFBSSxJQUFJLENBQUMsVUFBVSxFQUFFO1lBQ2pCLElBQUksQ0FBQyxVQUFVLENBQUMsTUFBTSxFQUFFLENBQUM7U0FDNUI7SUFDTCxDQUFDO0lBR0wsWUFBQztBQUFELENBbkNBLEFBbUNDLElBQUEiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbInZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XHJcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbiAgICB9O1xyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpIiwiLyoqVGhpcyBjbGFzcyBpcyBhdXRvbWF0aWNhbGx5IGdlbmVyYXRlZCBieSBMYXlhQWlySURFLCBwbGVhc2UgZG8gbm90IG1ha2UgYW55IG1vZGlmaWNhdGlvbnMuICovXHJcblxyXG4vKlxyXG4qIOa4uOaIj+WIneWni+WMlumFjee9rjtcclxuKi9cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgR2FtZUNvbmZpZ3tcclxuICAgIHN0YXRpYyB3aWR0aDpudW1iZXI9NDgwO1xyXG4gICAgc3RhdGljIGhlaWdodDpudW1iZXI9ODAwO1xyXG4gICAgc3RhdGljIHNjYWxlTW9kZTpzdHJpbmc9XCJmaXhlZHdpZHRoXCI7XHJcbiAgICBzdGF0aWMgc2NyZWVuTW9kZTpzdHJpbmc9XCJub25lXCI7XHJcbiAgICBzdGF0aWMgYWxpZ25WOnN0cmluZz1cInRvcFwiO1xyXG4gICAgc3RhdGljIGFsaWduSDpzdHJpbmc9XCJsZWZ0XCI7XHJcbiAgICBzdGF0aWMgc3RhcnRTY2VuZTphbnk9XCJcIjtcclxuICAgIHN0YXRpYyBzY2VuZVJvb3Q6c3RyaW5nPVwiXCI7XHJcbiAgICBzdGF0aWMgZGVidWc6Ym9vbGVhbj1mYWxzZTtcclxuICAgIHN0YXRpYyBzdGF0OmJvb2xlYW49ZmFsc2U7XHJcbiAgICBzdGF0aWMgcGh5c2ljc0RlYnVnOmJvb2xlYW49ZmFsc2U7XHJcbiAgICBzdGF0aWMgZXhwb3J0U2NlbmVUb0pzb246Ym9vbGVhbj10cnVlO1xyXG4gICAgY29uc3RydWN0b3IoKXt9XHJcbiAgICBzdGF0aWMgaW5pdCgpe1xyXG4gICAgICAgIHZhciByZWc6IEZ1bmN0aW9uID0gTGF5YS5DbGFzc1V0aWxzLnJlZ0NsYXNzO1xyXG5cclxuICAgIH1cclxufVxyXG5HYW1lQ29uZmlnLmluaXQoKTsiLCJpbXBvcnQgR2FtZUNvbmZpZyBmcm9tIFwiLi9HYW1lQ29uZmlnXCI7XHJcbmltcG9ydCBHYW1lQmdNYXAgZnJvbSBcIi4vbG9naWMvR2FtZUJnTWFwXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHYW1lUGFuZWwge1xyXG5cclxuICAgIHByaXZhdGUgX3ZpZXc6IGZhaXJ5Z3VpLkdDb21wb25lbnQ7XHJcbiAgICAvKipcclxuICAgICAqIDAgaWRsXHJcbiAgICAgKiAxIGVudGVyXHJcbiAgICAgKiAyIGV4aXRcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBjdXJTdGF0ZTogbnVtYmVyID0gMDtcclxuXHJcbiAgICBwcml2YXRlIG1hcExvZ2ljOiBHYW1lQmdNYXBcclxuXHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLmluaXQoKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGluaXQoKSB7XHJcbiAgICAgICAgdGhpcy5fdmlldyA9IGZhaXJ5Z3VpLlVJUGFja2FnZS5jcmVhdGVPYmplY3QoXCJHYW1lXCIsIFwiR2FtZVwiKS5hc0NvbTtcclxuICAgICAgICB0aGlzLl92aWV3LnNldFNpemUoR2FtZUNvbmZpZy53aWR0aCwgR2FtZUNvbmZpZy5oZWlnaHQpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBvbkVudGVyKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmN1clN0YXRlID09PSAxKSByZXR1cm47XHJcbiAgICAgICAgdGhpcy5jdXJTdGF0ZSA9IDE7XHJcbiAgICAgICAgZmFpcnlndWkuR1Jvb3QuaW5zdC5hZGRDaGlsZCh0aGlzLl92aWV3KTtcclxuXHJcbiAgICAgICAgdGhpcy5pbml0TWFwKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIG9uRXhpdCgpIHtcclxuICAgICAgICBpZiAodGhpcy5jdXJTdGF0ZSA9PT0gMikgcmV0dXJuO1xyXG4gICAgICAgIHRoaXMuY3VyU3RhdGUgPSAyO1xyXG4gICAgICAgIGZhaXJ5Z3VpLkdSb290Lmluc3QucmVtb3ZlQ2hpbGQodGhpcy5fdmlldyk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBpbml0TWFwKCkge1xyXG4gICAgICAgIGxldCBtYXAxID0gdGhpcy5fdmlldy5nZXRDaGlsZCgnbjAnKS5hc0NvbTtcclxuICAgICAgICBsZXQgbWFwMiA9IHRoaXMuX3ZpZXcuZ2V0Q2hpbGQoJ24xJykuYXNDb207XHJcbiAgICAgICAgaWYgKCF0aGlzLm1hcExvZ2ljKSB7XHJcbiAgICAgICAgICAgIHRoaXMubWFwTG9naWMgPSBuZXcgR2FtZUJnTWFwKG1hcDEsIG1hcDIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLm1hcExvZ2ljLnJ1bk1hcCgpO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IEdhbWVDb25maWcgZnJvbSBcIi4vR2FtZUNvbmZpZ1wiO1xyXG5pbXBvcnQgTG9hZGVyID0gbGF5YS5uZXQuTG9hZGVyO1xyXG5pbXBvcnQgSGFuZGxlciA9IGxheWEudXRpbHMuSGFuZGxlcjtcclxuaW1wb3J0IHsgTWFpblBhbmVsIH0gZnJvbSBcIi4vTWFpblBhbmVsXCI7XHJcbmltcG9ydCBVSU1nciBmcm9tIFwiLi91dGlscy9VSU1nclwiO1xyXG5cclxuY2xhc3MgTWFpbiB7XHJcblx0Y29uc3RydWN0b3IoKSB7XHJcblx0XHQvL+agueaNrklEReiuvue9ruWIneWni+WMluW8leaTjlx0XHRcclxuXHRcdGlmICh3aW5kb3dbXCJMYXlhM0RcIl0pIExheWEzRC5pbml0KEdhbWVDb25maWcud2lkdGgsIEdhbWVDb25maWcuaGVpZ2h0KTtcclxuXHRcdGVsc2UgTGF5YS5pbml0KEdhbWVDb25maWcud2lkdGgsIEdhbWVDb25maWcuaGVpZ2h0LCBMYXlhW1wiV2ViR0xcIl0pO1xyXG5cdFx0TGF5YVtcIlBoeXNpY3NcIl0gJiYgTGF5YVtcIlBoeXNpY3NcIl0uZW5hYmxlKCk7XHJcblx0XHRMYXlhW1wiRGVidWdQYW5lbFwiXSAmJiBMYXlhW1wiRGVidWdQYW5lbFwiXS5lbmFibGUoKTtcclxuXHRcdExheWEuc3RhZ2Uuc2NhbGVNb2RlID0gR2FtZUNvbmZpZy5zY2FsZU1vZGU7XHJcblx0XHRMYXlhLnN0YWdlLnNjcmVlbk1vZGUgPSBHYW1lQ29uZmlnLnNjcmVlbk1vZGU7XHJcblx0XHQvL+WFvOWuueW+ruS/oeS4jeaUr+aMgeWKoOi9vXNjZW5l5ZCO57yA5Zy65pmvXHJcblx0XHRMYXlhLlVSTC5leHBvcnRTY2VuZVRvSnNvbiA9IEdhbWVDb25maWcuZXhwb3J0U2NlbmVUb0pzb247XHJcblxyXG5cdFx0Ly/miZPlvIDosIPor5XpnaLmnb/vvIjpgJrov4dJREXorr7nva7osIPor5XmqKHlvI/vvIzmiJbogIV1cmzlnLDlnYDlop7liqBkZWJ1Zz10cnVl5Y+C5pWw77yM5Z2H5Y+v5omT5byA6LCD6K+V6Z2i5p2/77yJXHJcblx0XHRpZiAoR2FtZUNvbmZpZy5kZWJ1ZyB8fCBMYXlhLlV0aWxzLmdldFF1ZXJ5U3RyaW5nKFwiZGVidWdcIikgPT0gXCJ0cnVlXCIpIExheWEuZW5hYmxlRGVidWdQYW5lbCgpO1xyXG5cdFx0aWYgKEdhbWVDb25maWcucGh5c2ljc0RlYnVnICYmIExheWFbXCJQaHlzaWNzRGVidWdEcmF3XCJdKSBMYXlhW1wiUGh5c2ljc0RlYnVnRHJhd1wiXS5lbmFibGUoKTtcclxuXHRcdGlmIChHYW1lQ29uZmlnLnN0YXQpIExheWEuU3RhdC5zaG93KCk7XHJcblx0XHRMYXlhLmFsZXJ0R2xvYmFsRXJyb3IgPSB0cnVlO1xyXG5cclxuXHRcdC8v5r+A5rS76LWE5rqQ54mI5pys5o6n5Yi277yMdmVyc2lvbi5qc29u55SxSURF5Y+R5biD5Yqf6IO96Ieq5Yqo55Sf5oiQ77yM5aaC5p6c5rKh5pyJ5Lmf5LiN5b2x5ZON5ZCO57ut5rWB56iLXHJcblx0XHRMYXlhLlJlc291cmNlVmVyc2lvbi5lbmFibGUoXCJ2ZXJzaW9uLmpzb25cIiwgTGF5YS5IYW5kbGVyLmNyZWF0ZSh0aGlzLCB0aGlzLm9uVmVyc2lvbkxvYWRlZCksIExheWEuUmVzb3VyY2VWZXJzaW9uLkZJTEVOQU1FX1ZFUlNJT04pO1xyXG5cclxuXHR9XHJcblxyXG5cdG9uVmVyc2lvbkxvYWRlZCgpOiB2b2lkIHtcclxuXHRcdC8v5r+A5rS75aSn5bCP5Zu+5pig5bCE77yM5Yqg6L295bCP5Zu+55qE5pe25YCZ77yM5aaC5p6c5Y+R546w5bCP5Zu+5Zyo5aSn5Zu+5ZCI6ZuG6YeM6Z2i77yM5YiZ5LyY5YWI5Yqg6L295aSn5Zu+5ZCI6ZuG77yM6ICM5LiN5piv5bCP5Zu+XHJcblx0XHRMYXlhLkF0bGFzSW5mb01hbmFnZXIuZW5hYmxlKFwiZmlsZWNvbmZpZy5qc29uXCIsIExheWEuSGFuZGxlci5jcmVhdGUodGhpcywgdGhpcy5vbkNvbmZpZ0xvYWRlZCkpO1xyXG5cdH1cclxuXHJcblx0b25Db25maWdMb2FkZWQoKTogdm9pZCB7XHJcblx0XHQvL+WKoOi9vUlEReaMh+WumueahOWcuuaZr1xyXG5cdFx0Ly8gR2FtZUNvbmZpZy5zdGFydFNjZW5lICYmIExheWEuU2NlbmUub3BlbihHYW1lQ29uZmlnLnN0YXJ0U2NlbmUpO1xyXG5cdFx0TGF5YS5sb2FkZXIubG9hZChbe1xyXG5cdFx0XHR1cmw6ICdyZXMvTG9naW5fYXRsYXMwLnBuZycsIHR5cGU6IExvYWRlci5JTUFHRVxyXG5cdFx0fSwge1xyXG5cdFx0XHR1cmw6ICdyZXMvTG9naW4uZnVpJywgdHlwZTogTG9hZGVyLkJVRkZFUlxyXG5cdFx0fSwge1xyXG5cdFx0XHR1cmw6ICdyZXMvR2FtZV9hdGxhczAucG5nJywgdHlwZTogTG9hZGVyLklNQUdFXHJcblx0XHR9LCB7XHJcblx0XHRcdHVybDogJ3Jlcy9HYW1lLmZ1aScsIHR5cGU6IExvYWRlci5CVUZGRVJcclxuXHRcdH1dLCBMYXlhLkhhbmRsZXIuY3JlYXRlKHRoaXMsIHRoaXMub25Mb2FkZWQpKTtcclxuXHR9XHJcblxyXG5cdG9uTG9hZGVkKCk6IHZvaWQge1xyXG5cdFx0TGF5YS5zdGFnZS5hZGRDaGlsZChmYWlyeWd1aS5HUm9vdC5pbnN0LmRpc3BsYXlPYmplY3QpO1xyXG5cdFx0ZmFpcnlndWkuVUlQYWNrYWdlLmFkZFBhY2thZ2UoXCJyZXMvTG9naW5cIik7XHJcblx0XHRmYWlyeWd1aS5VSVBhY2thZ2UuYWRkUGFja2FnZShcInJlcy9HYW1lXCIpO1xyXG5cclxuXHRcdC8vIFVJTWdyLkluc3RhbmNlKCkuZW50ZXJMb2dpbigpO1xyXG5cdFx0VUlNZ3IuSW5zdGFuY2UoKS5lbnRlckdhbWUoKTtcclxuXHR9XHJcbn1cclxuLy/mv4DmtLvlkK/liqjnsbtcclxubmV3IE1haW4oKTtcclxuIiwiaW1wb3J0IEdhbWVDb25maWcgZnJvbSBcIi4vR2FtZUNvbmZpZ1wiO1xyXG5pbXBvcnQgTXVzaWNXaW4gZnJvbSBcIi4vdWkvTXVzaWNXaW5cIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBNYWluUGFuZWwge1xyXG4gICAgcHJpdmF0ZSBfdmlldzogZmFpcnlndWkuR0NvbXBvbmVudDtcclxuICAgIC8qKlxyXG4gICAgICogMCBpZGxcclxuICAgICAqIDEgZW50ZXJcclxuICAgICAqIDIgZXhpdFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGN1clN0YXRlOiBudW1iZXIgPSAwO1xyXG5cclxuICAgIHByaXZhdGUgYXVkaW9XaW46IE11c2ljV2luO1xyXG5cclxuICAgIHB1YmxpYyBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLmluaXQoKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGluaXQoKSB7XHJcbiAgICAgICAgdGhpcy5fdmlldyA9IGZhaXJ5Z3VpLlVJUGFja2FnZS5jcmVhdGVPYmplY3QoXCJMb2dpblwiLCBcIkxvZ2luXCIpLmFzQ29tO1xyXG4gICAgICAgIHRoaXMuX3ZpZXcuc2V0U2l6ZShHYW1lQ29uZmlnLndpZHRoLCBHYW1lQ29uZmlnLmhlaWdodCk7XHJcbiAgICAgICAgdGhpcy5iaW5kQnRuKHRoaXMuX3ZpZXcpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgYmluZEJ0bih2aWV3OiBmYWlyeWd1aS5HQ29tcG9uZW50KSB7XHJcbiAgICAgICAgdmlldy5nZXRDaGlsZChcIm4xXCIpLm9uQ2xpY2sodGhpcywgKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgLy9cclxuICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmlldy5nZXRDaGlsZChcIm11c2ljQnRuXCIpLm9uQ2xpY2sodGhpcywgKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLmF1ZGlvV2luKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmF1ZGlvV2luID0gbmV3IE11c2ljV2luKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5hdWRpb1dpbi5zaG93KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIG9uRW50ZXIoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuY3VyU3RhdGUgPT09IDEpIHJldHVybjtcclxuICAgICAgICB0aGlzLmN1clN0YXRlID0gMTtcclxuICAgICAgICBmYWlyeWd1aS5HUm9vdC5pbnN0LmFkZENoaWxkKHRoaXMuX3ZpZXcpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBvbkV4aXQoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuY3VyU3RhdGUgPT09IDIpIHJldHVybjtcclxuICAgICAgICB0aGlzLmN1clN0YXRlID0gMjtcclxuICAgICAgICBmYWlyeWd1aS5HUm9vdC5pbnN0LnJlbW92ZUNoaWxkKHRoaXMuX3ZpZXcpO1xyXG4gICAgfVxyXG5cclxufVxyXG4iLCJpbXBvcnQgR2FtZUNvbmZpZyBmcm9tIFwiLi4vR2FtZUNvbmZpZ1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgR2FtZUJnTWFwIHtcclxuXHJcbiAgICBwcml2YXRlIG1hcDE6IGZhaXJ5Z3VpLkdDb21wb25lbnQ7XHJcbiAgICBwcml2YXRlIG1hcDI6IGZhaXJ5Z3VpLkdDb21wb25lbnQ7XHJcbiAgICBwcml2YXRlIG1hcEhlaWd0aDogbnVtYmVyO1xyXG4gICAgcHJpdmF0ZSBzY3JlZW5IZWlnaHQ6IG51bWJlcjtcclxuICAgIHByaXZhdGUgc3BlZWQ6IG51bWJlciA9IDI7XHJcbiAgICBwcml2YXRlIG1hcFN0YXJ0WTogbnVtYmVyO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKG1hcDE6IGZhaXJ5Z3VpLkdDb21wb25lbnQsIG1hcDI6IGZhaXJ5Z3VpLkdDb21wb25lbnQpIHtcclxuICAgICAgICB0aGlzLm1hcDEgPSBtYXAxO1xyXG4gICAgICAgIHRoaXMubWFwMiA9IG1hcDI7XHJcbiAgICAgICAgdGhpcy5tYXBIZWlndGggPSB0aGlzLm1hcDEuaGVpZ2h0O1xyXG5cclxuICAgICAgICB0aGlzLm1hcFN0YXJ0WSA9IG1hcDEueTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgcnVuTWFwKCkge1xyXG4gICAgICAgIExheWEudGltZXIubG9vcCgxNiwgdGhpcywgdGhpcy5tb3ZlWVVwZGF0ZSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBtb3ZlWVVwZGF0ZSgpIHtcclxuICAgICAgICB0aGlzLnJ1bk1vdmVZKHRoaXMubWFwMSwgdGhpcy5zcGVlZCk7XHJcbiAgICAgICAgdGhpcy5ydW5Nb3ZlWSh0aGlzLm1hcDIsIHRoaXMuc3BlZWQpO1xyXG4gICAgICAgIGlmICh0aGlzLmlzVHJhbnNmb3JtKHRoaXMubWFwMSwgdGhpcy5tYXAyKSkge1xyXG4gICAgICAgICAgICB0aGlzLnRyYW5zZm9ybSh0aGlzLm1hcDEsIHRoaXMubWFwMik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmlzVHJhbnNmb3JtKHRoaXMubWFwMiwgdGhpcy5tYXAxKSkge1xyXG4gICAgICAgICAgICB0aGlzLnRyYW5zZm9ybSh0aGlzLm1hcDIsIHRoaXMubWFwMSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgcnVuTW92ZVkodGFyZ2V0LCBvZmZzZXRZKSB7XHJcbiAgICAgICAgdGFyZ2V0LnkgKz0gLW9mZnNldFk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBpc1RyYW5zZm9ybShtYXAxLCBtYXAyKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2cobWFwMS55LCBtYXAyLnkpO1xyXG4gICAgICAgIGlmIChtYXAxLnkgPD0gKHRoaXMubWFwU3RhcnRZIC0gdGhpcy5tYXBIZWlndGgpICYmXHJcbiAgICAgICAgICAgIG1hcDIueSA8PSB0aGlzLm1hcFN0YXJ0WSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgdHJhbnNmb3JtKG1hcDEsIG1hcDIpIHtcclxuICAgICAgICBtYXAxLnkgPSBtYXAyLnkgKyB0aGlzLm1hcEhlaWd0aDtcclxuICAgIH1cclxuXHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBNdXNpY1dpbiBleHRlbmRzIGZhaXJ5Z3VpLldpbmRvdyB7XHJcblxyXG4gICAgY29uc3RydWN0b3IoKSB7IHN1cGVyKCk7IH1cclxuXHJcbiAgICBwcm90ZWN0ZWQgb25Jbml0KCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuY29udGVudFBhbmUgPSBmYWlyeWd1aS5VSVBhY2thZ2UuY3JlYXRlT2JqZWN0KFwiTG9naW5cIiwgXCJBdWRpb1dpblwiKS5hc0NvbTtcclxuICAgICAgICB0aGlzLmNlbnRlcigpO1xyXG4gICAgICAgIHRoaXMuY29udGVudFBhbmUuZ2V0Q2hpbGQoXCJtdXNpY1N3aXRjaFwiKS5vbkNsaWNrKHRoaXMsIHRoaXMub25FdmVudE11c2ljKTtcclxuICAgICAgICB0aGlzLmNvbnRlbnRQYW5lLmdldENoaWxkKFwiZWZmZWN0U3dpdGNoXCIpLm9uQ2xpY2sodGhpcywgdGhpcy5vbkV2ZW50RWZmZWNrKTtcclxuICAgICAgICB0aGlzLmNvbnRlbnRQYW5lLmdldENoaWxkKFwiY2xvc2VCdG5cIikub25DbGljayh0aGlzLCB0aGlzLm9uRXZlbnRDbG9zZSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIG9uU2hvd24oKTogdm9pZCB7XHJcbiAgICAgICAgY29uc29sZS5sb2coMCk7XHJcbiAgICB9XHJcblxyXG4gICAgb25FdmVudE11c2ljKGV2ZW50KTogdm9pZCB7XHJcbiAgICAgICAgY29uc29sZS5sb2coMCk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG9uRXZlbnRFZmZlY2soZXZlbnQpOiB2b2lkIHtcclxuICAgICAgICBjb25zb2xlLmxvZygwKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgb25FdmVudENsb3NlKGV2ZW50KTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5oaWRlKCk7XHJcbiAgICB9XHJcblxyXG59IiwiaW1wb3J0IHsgTWFpblBhbmVsIH0gZnJvbSBcIi4uL01haW5QYW5lbFwiO1xyXG5pbXBvcnQgR2FtZVBhbmVsIGZyb20gXCIuLi9HYW1lUGFuZWxcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFVJTWdyIHtcclxuXHJcbiAgICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogVUlNZ3I7XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBJbnN0YW5jZSgpIHtcclxuICAgICAgICBpZiAoIVVJTWdyLmluc3RhbmNlKSB7XHJcbiAgICAgICAgICAgIFVJTWdyLmluc3RhbmNlID0gbmV3IFVJTWdyKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBVSU1nci5pbnN0YW5jZTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGxvZ2luUGFuZWw6IE1haW5QYW5lbDtcclxuICAgIHByaXZhdGUgZ2FtZVBhbmVsOiBHYW1lUGFuZWw7XHJcblxyXG4gICAgcHVibGljIGVudGVyTG9naW4oKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmxvZ2luUGFuZWwpIHtcclxuICAgICAgICAgICAgdGhpcy5sb2dpblBhbmVsID0gbmV3IE1haW5QYW5lbCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmxvZ2luUGFuZWwub25FbnRlcigpO1xyXG4gICAgICAgIGlmICh0aGlzLmdhbWVQYW5lbCkge1xyXG4gICAgICAgICAgICB0aGlzLmdhbWVQYW5lbC5vbkV4aXQoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGVudGVyR2FtZSgpIHtcclxuICAgICAgICBpZiAoIXRoaXMuZ2FtZVBhbmVsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZ2FtZVBhbmVsID0gbmV3IEdhbWVQYW5lbCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmdhbWVQYW5lbC5vbkVudGVyKCk7XHJcbiAgICAgICAgaWYgKHRoaXMubG9naW5QYW5lbCkge1xyXG4gICAgICAgICAgICB0aGlzLmxvZ2luUGFuZWwub25FeGl0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgY29uc3RydWN0b3IoKSB7IH1cclxuXHJcbn0iXX0=
